<font face="Courier New">
<font size="3">
<!-- <font face="宋体"> -->

[toc]

# 第七章 文件和数据格式化
- 学习目标：
1. 掌握文件的读写方法以及打开和关闭等基本操作
2. 理解数据结构的维度及其特点
3. 掌握一二维数据的存储格式和读写方法
4. 运用PIL库进行基本的图像处理
5. 运用json库进行数据的维度转换
6. 了解高维数据的存储格式和读写方法

## 7.1 文件的使用
- 要点：Python能够以文本和二进制两种方式处理文件
### 7.1.1 文件概述
[微实例7.1]理解文本文件和二进制文件的区别
```python
# [微实例7.1]理解文本文件和二进制文件的区别
textFile = open(r"C:\Users\Yxin1\Desktop\7.1.txt",
                "rt", encoding="utf-8")  # t 表示文本文件方式
print(textFile.readline())
textFile.close()
binFile = open(r"C:\Users\Yxin1\Desktop\7.1.txt", "rb")  # r 表示二进制文件方式
print(binFile.readline())
binFile.close()
```

### 7.1.2 文件的打开关闭
#### 1. open()函数
- 函数格式:
```python
<变量名> = open(<文件名>,<打开模式>)
```
#### 2. 文件的打开模式
| 文件的打开模式 |                           含义                            |
| :------------: | :-------------------------------------------------------: |
|      'r'       | 只读模式,如果文件不存在,返回异常FileNotFoundError,默认值  |
|      'w'       |        覆盖写模式,文件不存在则创建,存在则完全覆盖         |
|      'x'       | 创建写模式,文件不存在则创建,存在则返回异常FileExistsError |
|      'a'       |   追加写模式,文件不存在则创建,存在则在文件最后追加内容    |
|      'b'       |                      二进制文件模式                       |
|      't'       |                    文本文件模式,默认值                    |

- 注意:
1. open()函数默认采用'rt'(文本只读)模式
2. 读取二进制文件(图片、视频、音乐)需要使用'rb'读取
3. 文件试用结束后要用close()方法关闭,释放文件的使用权限
```python
<变量名>.close()
```

### 7.1.3 文件的读写
#### 1. 文件内容读取方法(共4个)
|          操作方法           |                                 含义                                 |
| :-------------------------: | :------------------------------------------------------------------: |
|     <变量名>.readall()      |               读入整个文件内容,返回一个字符串或字节流                |
|   <变量名>.read(size=-1)    | 从文件中读入整个文件内容,如果给出参数,读入前size长度的字符串或字节流 |
| <变量名>.readline(size=-1)  | 从文件中读入一行内容,如果给出参数,读取该行前size长度的字符串或字节流 |
| <变量名>.readlines(hint=-1) |   从文件中读取所有行,以每行元素为一个列表,如果给出参数,读入hint行    |

- [微实例7.2]文本文件逐行打印
```python
# [微实例7.2]文本文件逐行打印
import os
os.chdir('C:/Users/Yxin1/Desktop')
fname = input("输入要打开的文件:")
fo = open(fname, 'r')
for line in fo.readlines():
    print(line)
fo.close()
```

#### 2. 文件内容写入方法(共3个)
|            方法            |                            含义                             |
| :------------------------: | :---------------------------------------------------------: |
|     <变量名>.write(s)      |                向文件写入一个字符串或字节流                 |
| <变量名>.writelines(lines) |             将一个元素全为字符串的列表写入文件              |
|   <变量名>.seek(offset)    | 改变当前文件操作指针的位置:0-文件开头,1-当前位置,2-文件结尾 |
- [微实例7.3]向文件写入一个列表
```python
# [微实例7.3]向文件写入一个列表
import os
os.chdir('C:/Users/Yxin1/Desktop')
fname = input('请输入要写入的文件:')
fo = open(fname, 'w+')
ls = ['唐诗', '宋词', '元曲']
fo.writelines(ls)
fo.seek(0)
for line in fo:
    print(line)
fo.close()
```

<br>

## 7.2 模块5:PIL库的使用(pillow库)
### 7.2.1 PIL库概述
- 功能：
1. 图像归档:对图像进行批处理,生成图像预览,图像格式转换等
2. 图像处理:图像基本处理,像素处理,颜色处理等

### 7.2.2 PIL库Image类解析
#### 1. Image类的图像读取和创建方法(共4个)
|              方法               |               描述                |
| :-----------------------------: | :-------------------------------: |
|      Image.open(filename)       |       根据参数加载图像文件        |
|   Image.new(mode,size,color)    |   根据给定参数创建一个新的图像    |
| Image.frombytes(mode,size,data) |      根据像素点data创建图像       |
|         Image.verify()          | 对图像文件完整性进行检查,返回异常 |
- 例子:
```python
from PIL import Image
im = Image.open('D:/pycode/birdnest.jpg')
```

#### 2. Image类的常用属性(共4个)
|     属性      |                              描述                               |
| :-----------: | :-------------------------------------------------------------: |
| Image.format  |       标识图像格式或来源,如果图像不是从文件读取,值为None        |
|  Image.mode   | 图像的色彩模式,"L"为灰度图像,"RGB"为真彩色图像,"CMYK"为出版图像 |
|  Image.size   |         图像宽度和高度,单位是像素(px),返回值是二元元组          |
| Image.palette |               调色板属性,返回一个ImagePalette类型               |
- 例子:
```python
from PIL import Image
im = Image.open('D:/pycode/birdnest.jpg')
print(im.format,im.size,im.mode)
```

#### 3. Image类的序列图像操作方法(共2个)
Image能读取序列类图像文件,包括GIF,FLI等文件
- 注意:
open()方法打开图像自动加载序列中的第一帧,使用seek()和tell()方法可以在不同帧之间移动
|       方法        |           描述           |
| :---------------: | :----------------------: |
| Image.seek(frame) | 跳转并返回图像中的指定帧 |
|   Image.tell()    |     返回当前帧的序号     |
- [微实例7.4]GIF文件图像提取
```python

```











