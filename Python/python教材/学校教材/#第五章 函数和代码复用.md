<font face="Courier New">
<font size="3">
<!-- <font face="宋体"> -->

[toc]

# 第五章 函数和代码复用
- 学习目标：
- 1. 掌握函数的定义和调用方法
- 2. 理解函数的参数传递过程以及变量的作用范围
- 3. 了解lambda函数
- 4. 掌握时间日期标准库的使用
- 5. 理解函数递归的定义和使用方法
## 5.1 函数的基本使用
### 5.1.1 函数的定义
#### 1. def()函数
使用def保留字定义一个函数,语法形式如下:
- 语法形式
```python
def <函数体> (<参数列表>): # 参数列表中的参数为形参
    <函数体>
    return <返回值列表> # return可以省去
```
#### 2. 形式参数
<u>**函数定义**</u>中参数列表里面的参数是**形势参数**

#### 3. 调用函数
- 语法形式:
```python
<函数名>(<参数列表>) # 参数列表中的参数为实参
```
#### 4. 实际参数
参数列表中给出要<u>**传入函数内部**</u>的参数,这类参数称为**实际参数**

[微实例5.1] 生日歌
```python
def happy():
    print("Happy birthday to you!")

def happyB(name):
    happy()
    happy()
    print("Happy birthday,dear {}!".format(name))
    happy()

name1 = input("输入名字:")
happyB(name1)
```

### 5.1.3 lambda函数
#### 1. lambda函数的定义
使用lambda()函数定义一种特殊的函数——匿名函数,又称lambda函数(<u>将函数名作为函数结果返回</u>)
- 语法形式:
```python
<函数名> = lambda <参数列表> : <表达式>
```
- 例子
```python
>>>f = lambda x,y : x+y
>>>type(f)
<class 'function'>
>>>f(10,12)
22
```

<br>

## 5.2 函数的参数传递
### 5.2.1 可选参数和可变数量参数
#### 1. 可选参数:
在定义函数时,如果有些参数存在默认值,即部分参数不一定需要调用程序输入,可以在定义函数时直接为这些参数指定默认值
- 例子：
```python
>>>def dup(str,times = 2):
       print(str*times)
>>>dup("knock~")
knock~knock~
>>>dup("knock~",4)
knock~knock~knock~knock~
```
- 注意:可选参数必须定义在非可选参数的后面
#### 2. 可变数量参数
在函数定义时,通过在参数前增加星号(*)实现,带有星号的可变参数只能出现在参数列表的最后
- 注意:这些参数被当作元组类型传递到函数中
- 例子:
```python
>>>def vfunc(a,*b):
       print(type(b))
       for n in b:
           a += n
       return a
>>>vfunc(1,2,3,4,5)
<class 'tuple'>
15
```
- 注意:
调用vfunc()函数时输入的(2,3,4,5)被当作元组传递给b

### 5.2.2 参数的位置和名称传递
- 例子：
假设func()函数有6个参数,其中参数分别表示两组三位坐标值
```python
# 函数定义
def func(x1,y1,z1,x2,y2,z2):
    return

# 实际调用
result = func(1,2,3,4,5,6)
```
- 形参名称输入实参的方式:
```python
# 函数调用
result = func(x2=4, y2=5, z2=6, x1=1, y1=2, z1=3)
```

### 5.2.3 函数的返回值
return语句用来退出函数,并将程序返回到函数<u>被**调用的位置**</u>继续执行
return语句可以将0个、1个或多个函数运算后的结果返回给函数<u>**被调用处**</u>的变量
- 例子:
```python
def func(a,b):
    return a*b

s = func("knock~",2)
t = func(2,3)
print(s,t)
print(type(s),type(t))
```
- 结果:
```python
knock~knock~  6
<class 'str'> <class 'int'>
```

### 5.2.4 函数对变量的作用(先跳过,等学完第六章再学)

<br>

## 5.3 模块3:datetime库的使用
### 5.3.1 datetime库概述
datetime库可以从系统中获得时间,并以用户选择的格式输出
#### 1. datetime库以类的方式提供多种日期和时间表达方式
|    datetime函数    |                   描述                    |
| :----------------: | :---------------------------------------: |
|   datetime.date    |      日期表示类,可以表示年、月、日等      |
|   datetime.time    | 时间表示类,可以表示小时、分钟、秒、毫秒等 |
| datetime.datetime  |   日期和时间表示的类,功覆盖date和time类   |
| datetime.timedelta |            与时间间隔有关的类             |
|  datetime.tzinfo   |          与时区有关的信息表示类           |

#### 2. *引用datetime类的方式:
```python
from datetime import datetime
```

### 5.3.2 datetime库解析
#### 1. datetime.now()函数
使用datetiem.now()获得当前日期和时间<u>**时间对象**</u>
- 作用:
返回一个datetime类型,表示当前的日期和时间,精确到微秒
- 例子:
```python
from datetime import datetime
today = datetime.now()
print(today)
print(type(today))
```
- 结果:
```python
2021-10-29 18:52:32.896267
<class 'datetime.datetime'>
```

#### 2. datetime.utcnow()函数
使用datetime.utcnow()获得当前日期和时间对应的UTC(世界标准时间)时间<u>**对象**</u>
- 作用:
返回一个datetime类型,表示当前日期和时间的UTC表示,精确到微秒
- 例子:
```python
from datetime import datetime
today = datetime.utcnow()
print(today)
print(type(today))
```
- 结果:
```python
2021-10-29 12:08:14.283498
<class 'datetime.datetime'>
```

#### 3. datetime()函数
使用datetime()构造一个日期和时间对象
- 作用:
返回一个datetime类型,表示<u>**指定的**</u>日期和时间,精确到微秒
- 参数:
year:指定的年份
month:指定的月份
day:指定的日期
hour:指定的小时
minute:指定的分钟数
second:指定的秒数
microsecond:指定的微秒数
- 注意:其中hour,minute,second,microsecon可以省略
- 例子:
```python
someday = datetime(2021,7,12,0,0)
```

#### 4. datetime类常用的时间格式化方法
|           属性           |                   描述                   |
| :----------------------: | :--------------------------------------: |
|   someday.isoformat()    |         采用ISO 8601标准显示时间         |
|   someday.isoweekday()   |        根据日期计算星期后返回1~7         |
| someday.strftime(format) | 根据格式化字符串format进行格式显示的方法 |

- isoformat()和isrweekday()使用方法:
```python
from datetime import datetime
today = datetime.now()
s = today.isoformat()
t = today.isoweekday()
print(s)
print(t)
```
- 结果:
```python
2021-10-29T12:51:03.758691
5
```

- strftime()方法:
strftime()方法是时间格式化最有效的方法
```python
someday.strftime("%Y-%m-%d %H:%M:%S")
```
- 结果:
```python
2021-10-29 12:51:03
```
#### 5. strftime()方法的格式化控制符
| 格式化字符串 |  日期/时间  |      值范围      |
| :----------: | :---------: | :--------------: |
|      %Y      |    年份     |    0001~9999     |
|      %m      |    月份     |      01~12       |
|      %B      |    月名     | January~December |
|      %b      |  月名缩写   |     Jan~Dec      |
|      %d      |    日期     |      01~31       |
|      %A      |    星期     |  Monday~Sunday   |
|      %a      |  星期缩写   |     Mon~Sun      |
|      %H      | 小时(24h制) |      00~23       |
|      %I      | 小时(12h制) |      01~12       |
|      %p      |   上/下午   |      AM,PM       |
|      %M      |    分钟     |      00~59       |
|      %S      |     秒      |      00~59       |

- 例子:
```python
from datetime import datetime
now = datetime.now()
a = now.strftime("%Y-%m-%d")
b = now.strftime("%Y-%m-%d,%I:%M:%S %p")
print(a, "\n", b)
print("今天是{0:%Y}年{0:%m}月{0:%d}日".format(now))
```
- 结果:
```python
2021-10-30 
2021-10-30,10:26:06 AM
今天是2021年10月30日
```

<br>

## 5.4 实例7:七段数码管绘制
### 5.4.1 实例代码1
- 代码:
```python
# e7.1DrawSevenSegDisplay
import turtle
from datetime import datetime


def drawline(draw):  # 绘制单段数码管
    turtle.pen(speed=0)
    turtle.pendown() if draw else turtle.penup()
    turtle.fd(40)
    turtle.right(90)


def drawDigit(d):  # 根据数字绘制七段数码管
    drawline(True) if d in [2, 3, 4, 5, 6, 8, 9] else drawline(False)
    drawline(True) if d in [0, 1, 3, 4, 5, 6, 7, 8, 9] else drawline(False)
    drawline(True) if d in [0, 2, 3, 5, 6, 8, 9] else drawline(False)
    drawline(True) if d in [0, 2, 6, 8] else drawline(False)
    turtle.left(90)
    drawline(True) if d in [0, 4, 5, 6, 8, 9] else drawline(False)
    drawline(True) if d in [0, 2, 3, 5, 6, 7, 8, 9] else drawline(False)
    drawline(True) if d in [0, 1, 2, 3, 4, 7, 8, 9] else drawline(False)
    turtle.right(180)
    turtle.penup()
    turtle.fd(25)


def drawdata(data):  # 获得要输出的数字
    for i in data:
        try:
            a = eval(i)
            drawDigit(a)
        except SyntaxError:
            turtle.fd(25)


def main():  # 主程序
    turtle.setup(800, 350, 200, 200)
    turtle.penup()
    turtle.fd(-400)
    turtle.pensize(5)
    now = datetime.now()
    drawdata(now.strftime("%Y %m%d %I%M%S"))
    turtle.hideturtle()
    turtle.done()


main()
```

### 5.4.2 实例代码2
```python
# e7.2DrawSevenSegDisplay
import turtle
from datetime import datetime


def drawgap():  # 绘制数码管间隔
    turtle.penup()
    turtle.fd(5)


def drawline(draw):  # 绘制单端数码管
    drawgap()
    turtle.pen(speed=0)
    turtle.pendown() if draw else turtle.penup()
    turtle.fd(40)
    drawgap()
    turtle.right(90)


def drawDigit(d):  # 根据数字绘制七段数码管
    drawline(True) if d in [2, 3, 4, 5, 6, 8, 9] else drawline(False)
    drawline(True) if d in [0, 1, 3, 4, 5, 6, 7, 8, 9] else drawline(False)
    drawline(True) if d in [0, 2, 3, 5, 6, 8, 9] else drawline(False)
    drawline(True) if d in [0, 2, 6, 8] else drawline(False)
    turtle.left(90)
    drawline(True) if d in [0, 4, 5, 6, 8, 9] else drawline(False)
    drawline(True) if d in [0, 2, 3, 5, 6, 7, 8, 9] else drawline(False)
    drawline(True) if d in [0, 1, 2, 3, 4, 7, 8, 9] else drawline(False)
    turtle.right(180)
    turtle.penup()
    turtle.fd(25)


def drawdata(data):  # 获得要输出的内容
    turtle.pencolor("red")
    for i in data:
        if i == '-':
            turtle.write('年', font=('宋体', 18, 'normal'))
            turtle.pencolor('green')
            turtle.fd(40)
        elif i == '=':
            turtle.write('月', font=('宋体', 18, 'normal'))
            turtle.pencolor('blue')
            turtle.fd(40)
        elif i == '+':
            turtle.write('日', font=('宋体', 18, 'normal'))
            turtle.pencolor('black')
            turtle.fd(40)
        elif i == '.':
            turtle.write('点', font=('宋体', 18, 'normal'))
            turtle.fd(40)
        elif i == ',':
            turtle.write('分', font=('宋体', 18, 'normal'))
            turtle.fd(40)
        elif i == ';':
            turtle.write('秒', font=('宋体', 18, 'normal'))
        else:
            drawDigit(eval(i))


def main():  # 主程序
    turtle.setup(800, 350, 200, 200)
    turtle.penup()
    turtle.fd(-400)
    turtle.pensize(5)
    now = datetime.now()
    drawdata(now.strftime("%Y-%m=%d+%I.%M,%S;"))
    turtle.hideturtle()
    turtle.done()


main()
```

## 5.5 代码复用和模块化设计
### 5.5.1 函数
函数是程序的一种基本抽象方式,他将一系列代码组织起来通过命名供其他程序使用

### 5.5.2 对象
对象是程序的一种高级抽象方式,他将程序代码组织为更高级别的类
#### 1. 对象包括表征对象特征的属性和代表对象操作的方法

### 5.5.3 模块化设计
模块化设计通过函数或对象的封装功能将程序划分成主程序、子程序和子程序间关系的表达
- 基本要求:
- 1. 紧耦合:尽可能合理划分功能块,功能块内部耦合紧密
- 2. 松耦合:模块间关系尽可能简单,功能块之间耦合度低

## 5.6 函数的递归
- 要点:函数定义中调用函数自身的方式形成递归
### 5.6.1 递归的关键特征
- 基例:
当递归到底时,需要一个能直接算出值的表达式
- 1. 存在一个或多个基例,基例不需要再次递归,他是确定的表达式
- 2. 所有递归链要以一个或多个基例结尾

### 5.6.2 递归的使用方法
[微实例5.2] 阶乘的计算
```python
# [微实例5.2] 阶乘的计算
def func(n):
    if n == 0:
        return 1
    else:
        return n * func(n-1)


num = input("please enter a number:")
print(func(int(num)))
```
[微实例5.3]字符串反转
```python
# [微实例5.3]字符串反转
def reverse(s):
    if s == '':
        return s
    else:
        return(reverse(s[1:])+s[0])


str = input('please enter a string:')
print(reverse(str))
```

## 5.7  实例8:科赫曲线绘制



































