<font face="Courier New">
<font size="3">
<!-- <font face="宋体"> -->

[toc]

# 第六章 组合数据类型
- 学习目标:
- 1. 了解3类基本组合数据类型
- 2. 理解列表概念并掌握Python中列表的使用
- 3. 理解字典概念并掌握Python中字典的使用
- 4. 运用列表管理采集的信息,构建数据结构
- 5. 运用字典处理复杂的数据信息
- 6. 运用组合数据类型进行文本词频统计

## 6.1 组合数据类型概述
### 6.1.1 序列类型
- 1. 序列类型是一维元素向量
- 2. 元素之间存在先后关系
- 3. 通过序号访问
- 序列分类：可变序列list(列表)，不可变序列tuple(元组)、str(字符串)
#### 1. 序列类型的通用操作符和函数
|     操作符     |                  描述                  |
| :------------: | :------------------------------------: |
|     x in s     |  if x是s的元素,返回True,否则返回False  |
|   x not in s   | if x不是s的元素,返回True,否则返回False |
|     s + t      |         连接s和t(需要统一类型)         |
| s * n 或 n * s |             将序列s复制n次             |
|      s[i]      |        索引,返回序列的第i个元素        |
|    s[i:j:k]    |     分片,返回i到j-1个元素,步长为k      |
|     len(s)     |         序列s的元素个数(长度)          |
|     min(s)     |           序列s中的最小元素            |
|     max(s)     |           序列s中的最大元素            |

#### 2. 查找序列元素
1. .index()方法
从序列中找出某个str第一个匹配项的位置
- 语法:str.index(str, beg=0, end=len(string))
- str:指定检索的字符串
- beg:开始索引，默认为0
- end:结束索引，默认为字符串的长度
1. .find()方法
检测序列中是否包含str,返回str,否则返回-1(注意,不适用于列表)
- 语法:str.find(str, beg=0, end=len(string))
- str:指定检索的字符串
- beg:开始索引，默认为0
- end:结束索引，默认为字符串的长度
- 
#### 3. 计算str的出现次数
1. .count()方法
从序列中计算某个str出现的次数
- 语法:str.count(str)
- str:指定检索的字符串

### 6.1.2 集合类型
- 1. 集合包含0个或多个数据项的无序组合
- 2. 集合中的元素不可重复
- 3. 集合中元素只能是固定数据类型:整数、浮点数、字符串、元组等(不包括列表、字典和集合类型本身为可变数据类型)

#### 1. 哈希运算(hash()函数)
判断是否为固定数据类型
如果能进行哈希运算,则是固定数据类型,否则不是
哈希运算可以将任意长度的二进制值映射为较短的固定长度的二进制值
- 例子:
```python
hash("PYTHON")
hash("PYTHON IS GOOD")
```
#### 2. 如何生成集合
1. 赋值语句
集合用大括号({})表示,可以用赋值语句生成一个集合
- 例子:
``` python
S = {425,'BIT',(10,'CS'),424}
```
2. set()函数
set(x)可以用于生成集合,输入的参数可以是任何组合数据类型,返回结果是一个无重复且排序任意的集合
- 例子:
```python
W = set('apple')
V = set(('cat','dog','tiger','human'))
```
#### 3. 集合类型的操作符
|                  操作符                  |                           描述                           |
| :--------------------------------------: | :------------------------------------------------------: |
|          S-T 或 S.difference(T)          |       返回一个新集合,包括在集合S中但不在T中的元素        |
|      S-=T 或 S.difference_update(T)      |          更新集合S,包括在集合S中但不在T中的元素          |
|         S&T 或 S.intersection(T)         |        返回一个辛几何.包括同时在集合S和T中的元素         |
|     S&=T 或 S.intersection_update(T)     |           更新集合S,包括同时在集合S和T中的元素           |
|     S^T 或 S.symmetric_difference(T)     | 返回一个新集合,包括S和T中的元素,但不包括同时在其中的元素 |
| S^=T 或 S.symmetric_difference_update(T) |   更新集合S,包括S和T中的元素,但不包括同时在其中的元素    |
|            S\|T 或 S.union(T)            |         返回一个新集合,包括集合S和T中的所有元素          |
|        S\|=T 或 S.union_update(T)        |            更新集合S,包括集合S和T中的所有元素            |
- 上述操作符表达了集合类型的4这种基本操作:
- 交集(&)、并集(|)、差集(-)、补集(^)

#### 4. 集合类型的操作函数或方法
##### 1. 添加元素
1. S.add(x)
如果数据项x不在集合S中,将x添加到S
##### 2. 删除元素
1. S.discard(x)
如果x在集合S中,移除该元素
2. S.remove(x)
如果x在集合S中,移除该元素,否则产生KeyError异常
##### 3. 基本操作
1. S.clear()
移除S中的所有数据项
2. S.copy()
返回集合S的一个副本
3. S.pop()
随机返回集合S中的一个元素,如果S为空,产生KeyError错误
4. S.isdisjoint(T)
如果集合S与T没有相同元素,返回True

- 例子:
```python
S = {'python','bit',123,'good'} # 成员关系测试
>>>'BIT' in S
B = (123,'python','bit',123,'good') # 元素去重
>>>set(B) # 建立集合
>>>newS = tuple(set(B)-{'python'}) # 去重同时删除数据项
```
- 结果:
```python
False
{123,'good','bit','python'}
('good',123,'bit')
```
#### 5. 注意
集合类型不包含重复元素,因此对一维数据进行去重或进行数据重复处理时,一般通过集合来完成

### 6.1.3 映射类型
- 1. "键-值"数据项的组合:元素为(key,value)
- 2. 元素之间无序
- 3. 键值对(key,value)是一种二元关系

<br>

## 6.2 列表类型和操作
### 6.2.1 列表类型的概念
列表list是包含0个或多个对象引用的有序序列,属于序列类型
- 1. 没有长度限制
- 2. 可自由添加、删除或替换元素
- 3. 元素之间有序
- 4. 元素类型可以不同
#### 1. 如何生成列表
1. 赋值语句
列表用中括号([])表示
2. list()函数
list()函数将元组或字符串转化为列表
- 例子:
```python
>>>ls = [425,'bit',[10,'abc'],425]
>>>ls
>>>ls[2][-1][0]
>>>list((425,'bit',[10,'abc'],425))
```
- 结果:
```python
[425,'bit',[10,'abc'],425]
'a'
[425,'bit',[10,'abc'],425]
```
#### 2. 注意
- 1. 列表是对数据的引用 
- 2. 列表必须通过显式赋值才能产生,将一个列表赋值给另一个列表不会生成新的列表对象
- 例子:
```python
ls =  [425,'bit',[10,'abc'],425] # 用数据赋值产生列表ls
lt = ls # lt是ls所对应数据的引用,lt并不包含真实数据
ls[0] = 0
>>>lt
```
- 结果:
```python
[0,'bit',[10,'abc'],425]
```
### 6.2.2 列表类型的操作
#### 1. 列表类型特有的函数或方法
##### 1. 添加元素
1. ls.append(x)
在列表ls的最后添加一个元素x
2. ls.insert(i,x)
在列表ls的第i位置添加元素x
3. ls+=lt 或 ls.extend(lt)
将列表lt的元素增加到列表ls中
##### 2. 删除元素
1. del ls[i:j] 或 ls[i:j] = []
删除列表ls第i到第j项数据,步长为k
2. ls.clear()
删除列表ls中的所有元素
3. ls.pop(i)
将列表ls的第i项元素取出并删除该元素
4. ls.remove(x)
将列表中出现的第一个元素x删除
##### 3. 替换元素
1. ls[i] = x
替换列表ls第i项元素为x
2. ls[i:j:k] = lt
用列表lt替换列表ls中第i到第j-1项元素,步长为k
##### 4. 基本操作
1. ls.copy()
生成一个新列表,复制ls中的所有元素
2. ls*=n
更新列表ls,其元素重复n次
3. ls.reverse()
将列表ls中的元素反转
4. ls.sort()
将列表ls元素升序排列
5. sorted(ls)
将列表ls元素降序排列

#### 2. 注意
列表具有处理任意长度、混合类型数据的能力
<u>故当程序需要使用组合数据类型管理批量数据时,使用列表类型</u>

<br>

## 6.3 实例9:基本统计值计算
- 代码:
```python
# e9.1CalStatistics
from math import *


def getNum():  # 获取用户输入
    nums = []
    iNumStr = input('请输入数字(直接输入回车退出):')
    while iNumStr != '':
        nums.append(eval(iNumStr))
        iNumStr = input('请输入数字(直接输入回车退出):')
    return nums


def mean(numbers):  # 计算平均值(数字)
    s = 0.0
    for i in numbers:
        s += i
    s_averge = s/len(numbers)
    return s_averge


def dev(numbers, mean):  # 计算方差(数字,平均值)
    sdev = 0.0
    for i in numbers:
        sdev += (i-mean)**2
    sdev_1 = sqrt(sdev/(len(numbers)-1))
    return sdev_1


def median(numbers):  # 计算中位数(数字)
    sorted(numbers)
    l = len(numbers)
    if l % 2 == 0:
        med = (numbers[l//2] + numbers[l//2-1])/2  # 注意!此处使用//,表示整数相除
    else:
        med = numbers[l//2]
    return med


n = getNum()  # 主体函数(n = 用户输入)
m = mean(n)  # 获取平均值
x = dev(n, m)  # 获取方差
y = median(n)  # 获取中位数
print("平均值:{},方差:{:.2},中位数:{}".format(m, x, y))
```
## 6.4 字典类型和操作
- 要点:
字典是包含0个或多个键值对的集合,没有长度限制,可以根据'键'索引'值'的内容
### 6.4.1 字典类型的概念
#### 1. 字典的建立
字典可以通过大括号({})建立,建立模式如下:
```python
{<键1>:<值1>,<键2>:<值2>,...,<键n>:<值n>}
```
字典具有和集合类似的性质:
1. 键值对之间没有顺序
2. 键值对不能重复
即字典可以看作为元素是键值对的集合

#### 2. 字典的访问
一般来说,字典中键值对的访问模式如下,采用中括号格式:
```python
<值> = <字典变量>[<键>]
```
- 例子:
```python
Dcountry = {'中国':'北京','法国':'巴黎'}
>>>Dcountry['中国']
```
- 结果:
```python
'北京'
```
#### 3. 字典增加元素
通过中括号([])向其增加元素
- 例子:
```python
Dp = {}
Dp['2^10'] = 1024
print(Dp)
```
- 结果:
```python
{'2^10':1024}
```
#### 4. 注意
直接使用({})生成一个空的字典,而不是集合
生成空集合需要使用函数set()


### 6.4.2 字典类型的操作
#### 1. 字典类型的函数和方法
|       函数和方法        |                         描述                         |
| :---------------------: | :--------------------------------------------------: |
|       dict.keys()       |                   返回所有的键信息                   |
|      dict.values()      |                   返回所有的值信息                   |
|      dict.items()       |                    返回所有键值对                    |
| dict.get(<键>,<默认值>) |          键存在则返回相应值,否则返回默认值           |
| dict.pop(<键>,<默认值>) |   键存在则返回相应值,同时删除键值对,否则返回默认值   |
|     dict.popitem()      | 随机从字典中取出一个键值对,以元组(key,value)形式返回 |
|      dict.clear()       |                    删除所有键值对                    |
|     del dict[<键>]      |                删除字典中某一个键值对                |
|      <键> in dict       |        如果键在字典中则返回True,否则返回False        |
- 例子:
```python
Dcountry = {'中国':'北京','法国':'巴黎'}
>>>Dcountry.keys()
>>>list(Docuntry.values())
>>>Dcountry.items()
>>>'中国' in Docuntry # 只对键进行判断
>>>Dcountry.get('中国','悉尼') # '中国'在字典中存在,返回'中国'对应的值'北京'
>>>Dcountry.get('澳大利亚','悉尼') # '澳大利亚'在字典中不存在,则返回'悉尼'
```
- 结果:
```python
dict_keys(['中国','法国'])
['北京','巴黎']
dict_items([('中国','北京'),('法国','巴黎')])
True
'北京'
'悉尼'
```

<br>

## 6.5 模块4:jieba库的使用
第三方库
- 安装方式:
:\>pip install jieba 或者 pip3 install jieba

<br>

## 6.6 实例10:文本词频统计
### 6.6.1 Hamlet英文词频统计
```python
# e10.1CalHamlet
def getText():
    txt = open(r"C:\Users\Yxin1\Desktop\Hamlet.txt", "r").read()
    txt = txt.lower()
    for ch in '!"#$%&()*+,-./:;<=>?@[\\]^_`{|}~':
        txt = txt.replace(ch, " ")
    return txt


hamletTxt = getText()
words = hamletTxt.split()
counts = {}
# 方法一
'''
for word in words:
    if word in counts:
        counts[word] = counts[word] + 1
    else:
        counts[word] = 1
'''
# 方法二
for word in words:
    counts[word] = counts.get(word, 0) + 1


items = list(counts.items())
items.sort(key=lambda x: x[1], reverse=True)
for i in range(10):
    word, count = items[i]
    print("{0:<10}{1:>5}".format(word, count))

```

### 6.6.2 《三国演义》人物出场统计
```python
# e10.3CalThreeKingdoms
# 人物出场次数统计
import jieba
txt = open(r"C:\Users\Yxin1\Desktop\三国演义.txt", "r").read()
words = jieba.lcut(txt)
counts = {}
for word in words:
    if len(word) == 1:  # 排除单字符的分词结果
        continue
    else:
        counts[word] = counts.get(word, 0) + 1
items = list(counts.items())
items.sort(key=lambda x: x[1], reverse=True)
for i in range(10):
    word, count = items[i]
    print("{0:<10}{1:>5}".format(word, count))
```

# 3类基本组合数据类型
1. 序列
2. 集合
3. 列表